<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DiceRoller</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <link rel="stylesheet" href="styles.css">

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
</head>

<body style="background-image: url('/tavern.jpg');">
<header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Navbar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="roll.html">Dice</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="notes.html">Notes</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="library.html">Archives</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="misc.html">Misc.</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
              aria-expanded="false">
              Dropdown
            </a>
            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li>
                <hr class="dropdown-divider">
              </li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </li>
          
          
          
        </ul>
        
        
        
        
      </div>
    </div>
  </nav>
</header>
  <div class="container">

    <div class="row" id="switcher">

      <div class="col-sm-3" id="buffer1">

      </div>

      <!-- BUTTONS FOR DIE TYPE SELECTION -->
      <div id = "dice-row-container" class="">
        <div class="btn-group-vertical float-right" id="dice-row" role="group" aria-label="First group">
          <button type="button" id='d4' class="btn btn-secondary">d4</button>
          <button type="button" id='d6' class="btn btn-secondary">d6</button>
          <button type="button" id='d8' class="btn btn-secondary">d8</button>
          <button type="button" id='d12' class="btn btn-secondary">d12</button>
          <button type="button" id='d20' class="btn btn-secondary">d20</button>
          <button type="button" id='d100' class="btn btn-secondary">d100</button>
        </div>
      </div>

      

      
      <!-- ROLL BUTTON AND OUTPUT OF ROLL -->
      <div id = "result-container" class="col-sm-3">

        <div id="placeholder">
          0
        </div>
        <button type="button" id="roll-button" class="btn btn-primary">
          Choose a Die Size</button>



            <!-- CHOOSE NUMBER OF DICE -->
            <div class="center">
              <p>
              </p>

              <p></p>
              <p>
              </p>
              <div class="input-group">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-danger btn-number" data-type="minus" data-field="input-count">
                    <span class="glyphicon glyphicon-minus"> - </span>
                  </button>
                </span>
                <form id="form">
                  <input type="text" id="quantity" name="input-count" class="form-control input-number" value="1"
                    min="1" max="20">
                </form>
                <span class="input-group-btn">
                  <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="input-count">
                    <span class="glyphicon glyphicon-plus"> + </span>
                  </button>
                </span>
              </div>
              <p></p>
            </div>



          </div>

          <div class="col-sm-3" id = "buffer2">
          </div>

    </div>

  </div>



  <script>

    document.getElementById("form").reset();

    let dice = {
      sides: 1,
      count: 1,

      roll: function () {

        let sum = 0;
        let dicearray = [];
        for (i = 0; i < this.count; i++) {
          var randomNumber = (Math.floor(Math.random() * this.sides) + 1);
          sum += randomNumber;
        }
        return sum;
      }

    }



    //Prints dice roll to the page

    function printNumber(number) {
      var placeholder = document.getElementById('placeholder');
      placeholder.innerHTML = number;
    }

    var rollButton = document.getElementById('roll-button');

    rollButton.onclick = function () {
      dice.count = document.getElementById('quantity').value;
      console.log(document.getElementById('quantity').value);

      var result = dice.roll();
      printNumber(result);
    };


    function buttonHighlight(clicked) {

      let number = document.getElementById("placeholder");
      number.innerHTML = 0;

      let buttons = document.getElementsByClassName("btn-secondary");

      console.log(buttons);

      for (i = 0; i < buttons.length; i++) {
        buttons[i].style.backgroundColor = 'blue';
      }
      clicked.style.backgroundColor = 'red';


    }

    var rollButton = document.getElementById('roll-button');

    var d4 = document.getElementById('d4');
    d4.onclick = function () {
      dice.sides = 4;
      buttonHighlight(d4);
      rollButton.innerHTML = "Roll " + dice.count + "d4";
    };
    var d6 = document.getElementById('d6');
    d6.onclick = function () {
      dice.sides = 6;
      buttonHighlight(d6);
      rollButton.innerHTML = "Roll " + dice.count + "d6";
    };
    var d8 = document.getElementById('d8');
    d8.onclick = function () {
      dice.sides = 8;
      buttonHighlight(d8);
      rollButton.innerHTML = "Roll " + dice.count + "d8";
    };
    var d12 = document.getElementById('d12');
    d12.onclick = function () {
      dice.sides = 12;
      buttonHighlight(d12);
      rollButton.innerHTML = "Roll " + dice.count + "d12";
    };
    var d20 = document.getElementById('d20');
    d20.onclick = function () {
      dice.sides = 20;
      buttonHighlight(d20);
      rollButton.innerHTML = "Roll " + dice.count + "d20";
    };
    var d100 = document.getElementById('d100');
    d100.onclick = function () {
      dice.sides = 100;
      buttonHighlight(d100);
      rollButton.innerHTML = "Roll " + dice.count + "d100";
    };




    $('.btn-number').click(function (e) {
      e.preventDefault();

      fieldName = $(this).attr('data-field');
      type = $(this).attr('data-type');
      var input = $("input[name='" + fieldName + "']");
      var currentVal = parseInt(input.val());
      if (!isNaN(currentVal)) {





        if (type == 'minus') {

          if (currentVal > input.attr('min')) {
            input.val(currentVal - 1).change();
            dice.count = currentVal - 1;
            rollButton.innerHTML = "Roll " + dice.count + "d" + dice.sides;
          }
          if (parseInt(input.val()) == input.attr('min')) {
            $(this).attr('disabled', true);

          }

        } else if (type == 'plus') {

          if (currentVal < input.attr('max')) {
            input.val(currentVal + 1).change();
            dice.count = currentVal + 1;
            rollButton.innerHTML = "Roll " + dice.count + "d" + dice.sides;
          }
          if (parseInt(input.val()) == input.attr('max')) {
            $(this).attr('disabled', true);

          }

        }
      } else {
        input.val(0);
      }
    });
    $('.input-number').focusin(function () {
      $(this).data('oldValue', $(this).val());
    });
    $('.input-number').change(function () {

      minValue = parseInt($(this).attr('min'));
      maxValue = parseInt($(this).attr('max'));
      valueCurrent = parseInt($(this).val());

      name = $(this).attr('name');
      if (valueCurrent >= minValue) {
        $(".btn-number[data-type='minus'][data-field='" + name + "']").removeAttr('disabled')
        dice.count = valueCurrent;
        // rollButton.innerHTML = "Roll " + dice.count + "d" + dice.sides; 
      } else {
        alert('Sorry, the minimum value was reached');
        $(this).val(1);
        dice.count = 1;
      }
      if (valueCurrent <= maxValue && valueCurrent > 0) {
        $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
        dice.count = valueCurrent;
        // rollButton.innerHTML = "Roll " + dice.count + "d" + dice.sides; 
      }
      else if (valueCurrent <= maxValue) {
        $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
        dice.count = 1;
      }
      else {
        alert('Sorry, the maximum value was reached');
        $(this).val(20);
        dice.count = 20;
      }

      rollButton.innerHTML = "Roll " + dice.count + "d" + dice.sides;

    });
    $(".input-number").keydown(function (e) {
      // Allow: backspace, delete, tab, escape, enter and .
      if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
        // Allow: Ctrl+A
        (e.keyCode == 65 && e.ctrlKey === true) ||
        // Allow: home, end, left, right
        (e.keyCode >= 35 && e.keyCode <= 39)) {
        // let it happen, don't do anything
        return;
      }
      // Ensure that it is a number and stop the keypress
      if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
        e.preventDefault();
      }
    });



    var wideScreen = 800;

    var toggleBtnDirection = function () {
      var windowWidth = $(window).width();

      if (windowWidth > wideScreen) {
        document.getElementById('dice-row').classList.add('btn-group-vertical')
        document.getElementById('dice-row').classList.remove('btn-group');

        document.getElementById('switcher').classList.add('row');
        document.getElementById('switcher').classList.remove('col');

        document.getElementById('dice-row-container').classList.remove('row');
document.getElementById('result-container').classList.remove('shifted');

        // document.getElementById('buffer1').classList.add('col-sm-3');
        // document.getElementById('buffer2').classList.remove('row');

        // document.getElementById('dice-row').classList.add('float-right')
        // document.getElementById('dice-row').classList.remove('float-left');
      } else {
        document.getElementById('dice-row').classList.add('btn-group')
        document.getElementById('dice-row').classList.remove('btn-group-vertical');

        document.getElementById('switcher').classList.add('col');
        document.getElementById('switcher').classList.remove('row');

        document.getElementById('dice-row-container').classList.add('row');
        document.getElementById('result-container').classList.add('shifted');


        // document.getElementById('buffer1').classList.add('row');
        // document.getElementById('buffer2').classList.remove('col-sm-3');

        // document.getElementById('dice-row').classList.add('float-left')
        // document.getElementById('dice-row').classList.remove('float-right');
      }

    }


    

    toggleBtnDirection();
    window.addEventListener('resize', toggleBtnDirection);


  </script>





  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous">
    </script>

</body>

</html>